import{s as ne,v as ue,I as ae,x as oe,y as ie,z as g,r as V,A as re,B as se,C as de,w as M,D as me,E as ve,F as fe,G as Y,H as ce,g as i,J as O,K as pe,L as ge,M as $,N as Z,O as ye,P as we,Q as xe,R as be,S as Ve,T as W,U as ke,W as he,X as Ce,d as Ie,e as Pe,o as Se,f as Re,a as l,b as n,t as U,Y as Fe,_ as Be}from"./d.js";const Te=ue({autoGrow:Boolean,autofocus:Boolean,counter:[Boolean,Number,String],counterValue:Function,prefix:String,placeholder:String,persistentPlaceholder:Boolean,persistentCounter:Boolean,noResize:Boolean,rows:{type:[Number,String],default:5,validator:t=>!isNaN(parseFloat(t))},maxRows:{type:[Number,String],validator:t=>!isNaN(parseFloat(t))},suffix:String,modelModifiers:Object,...Ve(),...be()},"VTextarea"),b=ne()({name:"VTextarea",directives:{Intersect:ae},inheritAttrs:!1,props:Te(),emits:{"click:control":t=>!0,"mousedown:control":t=>!0,"update:focused":t=>!0,"update:modelValue":t=>!0},setup(t,E){let{attrs:R,emit:N,slots:f}=E;const s=oe(t,"modelValue"),{isFocused:r,focus:d,blur:C}=ie(t),I=g(()=>typeof t.counterValue=="function"?t.counterValue(s.value):(s.value||"").toString().length),c=g(()=>{if(R.maxlength)return R.maxlength;if(!(!t.counter||typeof t.counter!="number"&&typeof t.counter!="string"))return t.counter});function F(a,v){var m,x;!t.autofocus||!a||(x=(m=v[0].target)==null?void 0:m.focus)==null||x.call(m)}const P=V(),y=V(),A=re(""),B=V(),u=g(()=>t.persistentPlaceholder||r.value||t.active);function e(){var a;B.value!==document.activeElement&&((a=B.value)==null||a.focus()),r.value||d()}function o(a){e(),N("click:control",a)}function w(a){N("mousedown:control",a)}function S(a){a.stopPropagation(),e(),W(()=>{s.value="",Ce(t["onClick:clear"],a)})}function z(a){var m;const v=a.target;if(s.value=v.value,(m=t.modelModifiers)!=null&&m.trim){const x=[v.selectionStart,v.selectionEnd];W(()=>{v.selectionStart=x[0],v.selectionEnd=x[1]})}}const p=V(),q=V(Number(t.rows)),G=g(()=>["plain","underlined"].includes(t.variant));se(()=>{t.autoGrow||(q.value=Number(t.rows))});function T(){t.autoGrow&&W(()=>{if(!p.value||!y.value)return;const a=getComputedStyle(p.value),v=getComputedStyle(y.value.$el),m=parseFloat(a.getPropertyValue("--v-field-padding-top"))+parseFloat(a.getPropertyValue("--v-input-padding-top"))+parseFloat(a.getPropertyValue("--v-field-padding-bottom")),x=p.value.scrollHeight,D=parseFloat(a.lineHeight),K=Math.max(parseFloat(t.rows)*D+m,parseFloat(v.getPropertyValue("--v-input-control-height"))),L=parseFloat(t.maxRows)*D+m||1/0,h=he(x??0,K,L);q.value=Math.floor((h-m)/D),A.value=ke(h)})}de(T),M(s,T),M(()=>t.rows,T),M(()=>t.maxRows,T),M(()=>t.density,T);let k;return M(p,a=>{a?(k=new ResizeObserver(T),k.observe(p.value)):k==null||k.disconnect()}),me(()=>{k==null||k.disconnect()}),ve(()=>{const a=!!(f.counter||t.counter||t.counterValue),v=!!(a||f.details),[m,x]=fe(R),{modelValue:D,...K}=Y.filterProps(t),L=ce(t);return i(Y,$({ref:P,modelValue:s.value,"onUpdate:modelValue":h=>s.value=h,class:["v-textarea v-text-field",{"v-textarea--prefixed":t.prefix,"v-textarea--suffixed":t.suffix,"v-text-field--prefixed":t.prefix,"v-text-field--suffixed":t.suffix,"v-textarea--auto-grow":t.autoGrow,"v-textarea--no-resize":t.noResize||t.autoGrow,"v-input--plain-underlined":G.value},t.class],style:t.style},m,K,{centerAffix:q.value===1&&!G.value,focused:r.value}),{...f,default:h=>{let{id:H,isDisabled:j,isDirty:J,isReadonly:_,isValid:ee}=h;return i(ge,$({ref:y,style:{"--v-textarea-control-height":A.value},onClick:o,onMousedown:w,"onClick:clear":S,"onClick:prependInner":t["onClick:prependInner"],"onClick:appendInner":t["onClick:appendInner"]},L,{id:H.value,active:u.value||J.value,centerAffix:q.value===1&&!G.value,dirty:J.value||t.dirty,disabled:j.value,focused:r.value,error:ee.value===!1}),{...f,default:le=>{let{props:{class:Q,...X}}=le;return i(O,null,[t.prefix&&i("span",{class:"v-text-field__prefix"},[t.prefix]),Z(i("textarea",$({ref:B,class:Q,value:s.value,onInput:z,autofocus:t.autofocus,readonly:_.value,disabled:j.value,placeholder:t.placeholder,rows:t.rows,name:t.name,onFocus:e,onBlur:C},X,x),null),[[ye("intersect"),{handler:F},null,{once:!0}]]),t.autoGrow&&Z(i("textarea",{class:[Q,"v-textarea__sizer"],id:`${X.id}-sizer`,"onUpdate:modelValue":te=>s.value=te,ref:p,readonly:!0,"aria-hidden":"true"},null),[[we,s.value]]),t.suffix&&i("span",{class:"v-text-field__suffix"},[t.suffix])])}})},details:v?h=>{var H;return i(O,null,[(H=f.details)==null?void 0:H.call(f,h),a&&i(O,null,[i("span",null,null),i(pe,{active:t.persistentCounter||r.value,value:I.value,max:c.value,disabled:t.disabled},f.counter)])])}:void 0})}),xe({},P,y,B)}}),Me={class:"k"},Ae=Ie({__name:"CTF",setup(t){const E=[u=>!!(u!=null&&u.match(/\d+/))||"Must be a number",u=>BigInt(u)>2n||"Must be greater than 2"],R=[u=>!(u&&!u.match(/\d+/))||"Must be a number",u=>{const e=BigInt(u);return!(e<0n||e>=c.value)||`Must be between 0 and ${c.value-1n}`}];function N(u,e){for(;e!==0n;){const o=e;e=u%e,u=o}return u}function f(u,e){if(e<=1n)return 0n;const o=e;let w=0n,S=1n;for(;u>1n;){const z=u/e;let p=e;e=u%e,u=p,p=w,w=S-z*w,S=p}return S<0n&&(S+=o),S}function s(u,e,o){if(o===0n)return 0n;let w=1n;if(u%=o,u===0n)return 0n;for(;e>0n;)e%2n===1n&&(w=w*u%o),e=e>>1n,u=u*u%o;return w}const r=V("5"),d=V("11"),C=V("48"),I=V(),c=g(()=>r.value&&d.value?BigInt(r.value)*BigInt(d.value):1524157877515647915714744640673658430040741060333989936102274670076966070262981833538950468888038085808805693249090218478005129336316939313541391869824651884614844485976992554861850821137986271148099n),F=g(()=>r.value&&d.value?(BigInt(r.value)-1n)*(BigInt(d.value)-1n):null),P=g(()=>{if(r.value&&d.value){for(let u=2n;u<F.value;++u)if(N(u,F.value)===1n)return u}return 65537n}),y=g(()=>r.value&&d.value?f(P.value,F.value):null),A=g(()=>r.value&&d.value?`Enter a number between 0 and ${c.value-1n} (inclusive)`:void 0),B=g(()=>I.value&&y.value!=null?s(BigInt(I.value),y.value,c.value):null);return M([r,d,C],()=>{I.value=C.value?s(BigInt(C.value),P.value,c.value).toString():null}),(u,e)=>(Se(),Pe(Fe,null,{default:Re(()=>[e[6]||(e[6]=l("h3",null,"RSA Encryption Demo",-1)),e[7]||(e[7]=l("h4",null,"Introduction to RSA",-1)),e[8]||(e[8]=l("p",null," RSA (Rivest-Shamir-Adleman) is one of the first public-key cryptosystems and is widely used for secure data transmission. It's an asymmetric cryptographic algorithm, meaning it uses two different keys: a public key for encryption and a private key for decryption. ",-1)),e[9]||(e[9]=l("h4",null,"Choosing Prime Numbers",-1)),e[10]||(e[10]=l("p",null,[n("The process starts by selecting two distinct prime numbers, usually called "),l("em",null,"p"),n(" and "),l("em",null,"q"),n(".")],-1)),i(b,{rows:"1","auto-grow":"",label:"Prime p",inputmode:"numeric",rules:[...E,o=>o!==d.value||"Cannot be equal to q"],modelValue:r.value,"onUpdate:modelValue":e[0]||(e[0]=o=>r.value=o)},null,8,["rules","modelValue"]),i(b,{rows:"1","auto-grow":"",label:"Prime q",inputmode:"numeric",rules:[...E,o=>o!==r.value||"Cannot be equal to p"],modelValue:d.value,"onUpdate:modelValue":e[1]||(e[1]=o=>d.value=o)},null,8,["rules","modelValue"]),e[11]||(e[11]=l("ul",null,[l("li",null,[n("In our case, no checks are performed to ensure that "),l("em",null,"p"),n(" and "),l("em",null,"q"),n(" are prime.")]),l("li",null,"Also, in practice, these primes are very large, typically 2048 bits or more.")],-1)),e[12]||(e[12]=l("p",null,[l("a",{href:"https://en.wikipedia.org/wiki/Prime_number",target:"_blank"},"Learn more about prime numbers")],-1)),e[13]||(e[13]=l("h4",null,"Calculating n (the modulus)",-1)),e[14]||(e[14]=l("p",null,[l("em",null,"n"),n(" is the product of "),l("em",null,"p"),n(" and "),l("em",null,"q"),n(": "),l("em",null,"n = p * q")],-1)),i(b,{rows:"1","auto-grow":"",label:"n (p*q)",readonly:"","model-value":c.value},null,8,["model-value"]),e[15]||(e[15]=l("ul",null,[l("li",null,"This value is used in both the public and private keys."),l("li",null,"It's part of the encryption and decryption processes.")],-1)),e[16]||(e[16]=l("h4",null,"Calculating φ(n) (Euler's totient function)",-1)),e[17]||(e[17]=l("p",null,[l("em",null,"φ(n) = (p-1) * (q-1)")],-1)),i(b,{rows:"1","auto-grow":"",label:"φ(n)",readonly:"","model-value":F.value},null,8,["model-value"]),e[18]||(e[18]=l("ul",null,[l("li",null,"This step is crucial for generating the keys."),l("li",null,[n("It represents the count of numbers less than "),l("em",null,"n"),n(" that are coprime to "),l("em",null,"n"),n(".")])],-1)),e[19]||(e[19]=l("p",null,[l("a",{href:"https://en.wikipedia.org/wiki/Euler%27s_totient_function",target:"_blank"}," Learn more about Euler's totient function ")],-1)),e[20]||(e[20]=l("h4",null,"Choosing the Public Exponent (e)",-1)),e[21]||(e[21]=l("p",null,"Select a number e such that:",-1)),e[22]||(e[22]=l("ol",null,[l("li",null,"1 < e < φ(n)"),l("li",null,"e is coprime to φ(n) (their greatest common divisor is 1)")],-1)),i(b,{rows:"1","auto-grow":"",label:"Public Key (e)",readonly:"","model-value":P.value},null,8,["model-value"]),e[23]||(e[23]=l("ul",null,[l("li",null,[n("Common choices for "),l("em",null,"e"),n(" are 3, 5, 17, or 65537.")]),l("li",null,[n("In our demo the smallest suitable "),l("em",null,"e"),n(" is automatically calculated.")])],-1)),e[24]||(e[24]=l("h4",null,"Calculating the Private Exponent (d)",-1)),e[25]||(e[25]=l("p",null,[l("em",null,"d"),n(" is the modular multiplicative inverse of "),l("em",null,"e modulo φ(n)")],-1)),e[26]||(e[26]=l("p",null,[l("em",null,"d * e ≡ 1 (mod φ(n))")],-1)),i(b,{rows:"1","auto-grow":"",label:"Private Key (d)",readonly:"","model-value":y.value},null,8,["model-value"]),e[27]||(e[27]=l("ul",null,[l("li",null,[n("This means "),l("em",null,"(d * e) / φ(n)"),n(" leaves a remainder of 1.")]),l("li",null,[n("In our demo, "),l("em",null,"d"),n(" is automatically calculated using the modular inverse function.")])],-1)),e[28]||(e[28]=l("p",null,[l("a",{href:"https://en.wikipedia.org/wiki/Modular_multiplicative_inverse",target:"_blank"}," Learn more about modular arithmetic ")],-1)),e[29]||(e[29]=l("h4",null,"6. Generating the Keys",-1)),l("ul",Me,[l("li",null,[e[4]||(e[4]=n(" Public Key: ")),l("em",null,"{"+U(P.value)+", "+U(c.value)+"}",1)]),l("li",null,[e[5]||(e[5]=n(" Private Key: ")),l("em",null," {"+U(y.value)+", "+U(c.value)+"} ",1)])]),e[30]||(e[30]=l("p",null,"The public key is shared openly, while the private key must be kept secret.",-1)),e[31]||(e[31]=l("h4",null,"Encryption",-1)),e[32]||(e[32]=l("p",null,[n(" To encrypt a message "),l("em",null,"m"),n(": "),l("em",null,[n("c = m"),l("sup",null,"e"),n(" mod n")])],-1)),i(b,{rows:"1","auto-grow":"",label:"Message",inputmode:"numeric",hint:A.value,rules:R,modelValue:C.value,"onUpdate:modelValue":e[2]||(e[2]=o=>C.value=o)},null,8,["hint","modelValue"]),e[33]||(e[33]=l("ul",null,[l("li",null,[l("em",null,"m"),n(" must be less than "),l("em",null,"n")]),l("li",null,[l("em",null,"c"),n(" is the resulting ciphertext")])],-1)),i(b,{rows:"1","auto-grow":"",label:"Encrypted Message",inputmode:"numeric",hint:A.value,rules:R,modelValue:I.value,"onUpdate:modelValue":e[3]||(e[3]=o=>I.value=o)},null,8,["hint","modelValue"]),e[34]||(e[34]=l("h4",null,"Decryption",-1)),e[35]||(e[35]=l("p",null,[n(" To decrypt the ciphertext "),l("em",null,"c"),n(": "),l("em",null,[n("m = c"),l("sup",null,"d"),n(" mod n")])],-1)),i(b,{rows:"1","auto-grow":"",label:"Decrypted Message",readonly:"","model-value":B.value},null,8,["model-value"]),e[36]||(e[36]=l("p",null,[n("This recovers the original message "),l("em",null,"m"),n(".")],-1)),e[37]||(e[37]=l("h4",null,"Security of RSA",-1)),e[38]||(e[38]=l("p",null,[n(" The security of RSA relies on the practical difficulty of factoring the product of two large prime numbers. While factoring "),l("em",null,"n"),n(" to find "),l("em",null,"p"),n(" and "),l("em",null,"q"),n(" is theoretically possible, it becomes computationally infeasible with sufficiently large primes. ")],-1)),e[39]||(e[39]=l("p",null,[l("a",{href:"https://en.wikipedia.org/wiki/RSA_(cryptosystem)#Security_and_practical_considerations",target:"_blank"}," Learn more about RSA security ")],-1))]),_:1}))}}),Ne=Be(Ae,[["__scopeId","data-v-78a79c33"]]);export{Ne as default};
